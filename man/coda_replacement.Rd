% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/zero_replacement_imputation.R
\name{coda_replacement}
\alias{coda_replacement}
\title{Replacement of Missing Values and Below-Detection Zeros in Compositional Data}
\usage{
coda_replacement(
  X,
  DL = NULL,
  dl_prop = 0.65,
  eps = 1e-04,
  debug = FALSE,
  parameters = FALSE
)
}
\arguments{
\item{X}{A compositional dataset: numeric matrix or data frame where rows represent observations and columns represent parts.}

\item{DL}{An optional matrix or vector of detection limits. If \code{NULL}, the minimum non-zero value in each column of \code{X} is used.}

\item{dl_prop}{A numeric value between 0 and 1, used for initialization in the EM algorithm (default is 0.65).}

\item{eps}{A small positive value controlling the convergence criterion for the EM algorithm (default is \code{1e-4}).}

\item{debug}{Logical. If \code{TRUE}, displays intermediate steps and diagnostic messages (default is \code{FALSE}).}

\item{parameters}{Logical. If \code{TRUE}, returns additional output including estimated multivariate normal parameters (default is \code{FALSE}).}
}
\value{
If \code{parameters = FALSE}, returns a numeric matrix with imputed values.
If \code{parameters = TRUE}, returns a list with two components:
\describe{
  \item{X_imp}{The imputed compositional data matrix.}
  \item{info}{A list containing information about the EM algorithm parameters and convergence diagnostics.}
}
}
\description{
Performs imputation (replacement) of missing values and/or values below the detection limit (BDL) in compositional datasets,
using a parametric approach based on the multivariate normal distribution.
This function is designed to prepare compositional data for subsequent log-ratio transformations.
}
\details{
- Missing values are imputed based on a multivariate normal model.
- Zeros are treated as censored values and replaced accordingly.
- The EM algorithm iteratively estimates the missing parts and model parameters.
}
\examples{
# Simulate compositional data with zeros
set.seed(123)
X <- abs(matrix(rnorm(100), ncol = 5))
X[sample(length(X), 10)] <- 0  # Introduce some zeros

# Apply replacement
X_imp <- coda_replacement(X)
summary(X_imp)

}
\seealso{
\code{\link{cenLR}}, \code{\link{multRepl}} for alternative imputation methods.
}
